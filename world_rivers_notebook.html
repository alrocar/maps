<meta charset="utf-8">
<title>Franchise Notebook world_rivers</title>
<!--
 _______  ______ _______ __   _ _______ _     _ _____ _______ _______
 |______ |_____/ |_____| | \  | |       |_____|   |   |______ |______
 |       |    \_ |     | |  \_| |_____  |     | __|__ ______| |______

 _______  _____
 |______ |   __| |
 ______| |____\| |_____

 __   _  _____  _______ _______ ______   _____   _____  _     _
 | \  | |     |    |    |______ |_____] |     | |     | |____/
 |  \_| |_____|    |    |______ |_____] |_____| |_____| |    \_

-->
<style>
body {
  font-family: sans-serif;
  padding: 100px;
  background: #f7f7f7;
}
iframe {
  position: absolute;
  top: -10000px;
  left: -10000px;
}
a {
  font-size: large;
}


#click {
  background: #2257d9;
    padding: 20px;
    color: white;
    text-decoration: none;
    border-radius: 3px;
}

/*https://projects.lukehaas.me/css-loaders/*/
.loader,
.loader:after {
  border-radius: 50%;
  width: 10em;
  height: 10em;
}
.loader {
  margin: 60px auto;
  font-size: 10px;
  position: relative;
  text-indent: -9999em;
  border-top: 1.1em solid rgba(34,87,217, 0.2);
  border-right: 1.1em solid rgba(34,87,217, 0.2);
  border-bottom: 1.1em solid rgba(34,87,217, 0.2);
  border-left: 1.1em solid #2257d9;
  -webkit-transform: translateZ(0);
  -ms-transform: translateZ(0);
  transform: translateZ(0);
  -webkit-animation: load8 1.1s infinite linear;
  animation: load8 1.1s infinite linear;
}
@-webkit-keyframes load8 {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
@keyframes load8 {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

</style>

<div class="loader" id="loader">Loading Franchise...</div>

<center><a id="click" style="display:none" href="https://franchise.carto.io/" target="_blank">Click here to open Franchise SQL Notebook</a></center>
<script type="text/javascript">
const DATA = "{\"state\":{\"config\":{},\"connect\":{\"active\":\"carto\",\"status\":\"unconfigured\"},\"trash\":{\"open\":false,\"cells\":[]},\"deltas\":{\"open\":false,\"changes\":[]},\"notebook\":{\"layout\":[{\"rowId\":\"mtq6d0p\",\"items\":[{\"query\":\"SELECT cartodb_id, the_geom, the_geom_webmercator, up_cells, azimuth::float FROM aromeu.world_rivers\",\"id\":\"epshgt0\",\"error\":null,\"loading\":false,\"css\":\"@lw: 0.15;\\n@seed:#487eb0;\\n\\n\\n#layer {\\n  line-width: 2;\\n  line-join: round;\\n  line-cap: round;  \\n  line-color: #40739e;\\n  \\n   \\n  //N \\n  [azimuth< 6.3]{\\n    line-color:@seed;\\n  }\\n  //NW\\n  [azimuth< 5.625]{\\n    line-color:spin(@seed,-45);\\n  }\\n  //W\\n  [azimuth< 4.875]{\\n    line-color:spin(@seed,-90);\\n  }\\n  //SW\\n  [azimuth< 4.125]{\\n    line-color:spin(@seed,-130);\\n  }\\n  //S\\n  [azimuth< 3.375]{\\n    line-color:spin(@seed,180);\\n  }\\n  //SE\\n  [azimuth< 2.625]{\\n    line-color:spin(@seed,135);\\n  }\\n  //E\\n  [azimuth< 1.875]{\\n    line-color:spin(@seed,90);\\n  }\\n  //NE\\n  [azimuth< 1.125]{\\n    line-color:spin(@seed,45);\\n  }\\n  //N\\n  [azimuth<.375]{\\n    line-color:@seed;\\n  }\\n  \\n  \\n [ up_cells <= 27865050] {\\n   line-opacity: 0.9;\\n  line-width: @lw * 6;\\n  [zoom>6]{line-width: @lw * 10;}\\n  [zoom>7]{line-width: @lw * 20;}\\n  [zoom>8]{line-width: @lw * 30;}\\n  [zoom>9]{line-width: @lw * 90;}\\n}\\n[ up_cells <= 2086505] {\\n    line-opacity: 0.8;\\n  line-width: @lw * 4;\\n  [zoom>6]{line-width: @lw * 8;}\\n  [zoom>7]{line-width: @lw * 16;}\\n  [zoom>8]{line-width: @lw * 24;}\\n  [zoom>9]{line-width: @lw * 72;}\\n}\\n[ up_cells <= 200000] {\\n    line-opacity: 0.7;\\n  line-width: @lw * 3;\\n  [zoom>6]{line-width: @lw * 6;}\\n  [zoom>7]{line-width: @lw * 12;}\\n  [zoom>8]{line-width: @lw * 18;}\\n  [zoom>9]{line-width: @lw * 54;}\\n}\\n[ up_cells <= 100000] {\\n    line-opacity: 0.6;\\n  line-width: @lw * 1.75;\\n  [zoom>6]{line-width: @lw * 5;}\\n  [zoom>7]{line-width: @lw * 10;}\\n  [zoom>8]{line-width: @lw * 15;}\\n  [zoom>9]{line-width: @lw * 45;}\\n}\\n\\n[ up_cells <= 50000] {\\n    line-opacity: 0.5;\\n  line-width: @lw *1.5;\\n  [zoom>6]{line-width: @lw * 3;}\\n  [zoom>7]{line-width: @lw * 6;}\\n  [zoom>8]{line-width: @lw * 9;}\\n  [zoom>9]{line-width: @lw * 27;}\\n}\\n[ up_cells <= 8000] {\\n    line-opacity: 0.2;\\n  line-width: @lw;\\n  [zoom>6]{line-width: @lw * 2;}\\n  [zoom>7]{line-width: @lw * 4;}\\n  [zoom>8]{line-width: @lw * 6;}\\n  [zoom>9]{line-width: @lw * 18;}\\n}\\n  \\n\\n}\",\"result\":{\"columns\":[\"cartodb_id\",\"the_geom\",\"the_geom_webmercator\",\"up_cells\",\"azimuth\"],\"values\":[[7673,\"0105000020E610000001000000010200000002000000A0C0BBBBBB3BFBBF74101111116D414090AFAAAAAA2AFBBF74101111116D4140\",\"0105000020110F00000100000001020000000200000041804E66182107C107BBF6FD5A9D4F41B236FCBF991207C107BBF6FD5A9D4F41\",3166,1.5707963267949]]}}]}],\"forceRenderToken\":1}},\"autoconnect\":false,\"version\":2}";
</script>

<script type="text/javascript">
function sendData(target, src){
  console.log(src)
  if(typeof DATA != 'undefined'){
    target.postMessage(DATA, '*')
  }
}

window.addEventListener("message", function(e){
  console.log(e.data)
  if(e.data == 'franchise-request-import'){
    e.source.postMessage({ action: 'franchise-import', data: DATA }, '*')
  }
}, false)

setTimeout(function(){
  if(typeof DATA != 'undefined'){
    document.getElementById('click').style.display = ''
    document.getElementById('loader').style.display = 'none'
  }
}, 1500);
</script>

<iframe src="http://localhost:3000/reciever.html" onload="sendData(this.contentWindow, this.src)"></iframe>
<iframe src="https://franchise.carto.io/" onload="sendData(this.contentWindow, this.src)"></iframe>